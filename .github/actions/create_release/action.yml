name: Create Release
description: Create release from specific tag
inputs:
  tag:
    description: Tag to release
    required: true
  body:
    description: Body of release
    required: false
    default: ""

outputs:
  upload_url:
    value: ${{ steps.create_release.outputs.upload_url }}
    description: URL where to upload assets

runs:
  using: "composite"
  steps:
    - name: Create Release
      id: create_release
      shell: bash
      run: |
        url=$( curl --silent -H "Authorization: token ${{ github.TOKEN }}" \
          -H "Accept: application/vnd.github.v3+json" \
          -d '{"tag_name": "${{ inputs.tag }}", "body": "${{ inputs.body }}"}' \
          ${{ github.api_url }}/repos/${{ github.repository }}/releases \
        | jq --raw-output .upload_url \
        | sed -r "s/\{.*\}//g" )
        echo url
        echo "::set-output name=upload_url::$(echo $url)"